<script>
  // ===== Audio setup (exclusive playback) =====
  // Ensure these files exist in the SAME folder as index.html:
  // bg.mp3 (background), yes.mp3 (romantic), No.mp3 (playful/sad, capital N)
  const tracks = {
    bg:  new Audio("bg.mp3"),
    yes: new Audio("yes.mp3"),
    no:  new Audio("No.mp3"),   // case-sensitive
  };

  // Config
  tracks.bg.loop = true;  tracks.bg.volume = 0.35;
  tracks.yes.loop = true; tracks.yes.volume = 0.85;
  tracks.no.loop  = false;tracks.no.volume  = 0.95;

  // Preload (optional, helps reduce delay)
  ["bg","yes","no"].forEach(k => {
    tracks[k].preload = "auto";
    tracks[k].load();
  });

  let muted = false;

  function stopAll() {
    Object.values(tracks).forEach(a => { a.pause(); a.currentTime = 0; });
  }

  // Play exactly one track; everything else stops first
  async function playExclusive(name) {
    if (muted) return;
    stopAll();
    try {
      await tracks[name].play();
    } catch (e) {
      // Autoplay can be blocked until a user gesture. Our calls are from clicks, so should be fine.
      console.warn("Audio play failed:", name, e);
    }
  }

  // ===== Unlock page: start ONLY background loop =====
  function unlockPage() {
    lock.style.display = "none";
    mainCard.hidden = false;
    muteBtn.style.display = "inline-block";
    document.getElementById("noBtn").focus();

    // Start background (exclusive)
    playExclusive("bg");
  }

  // ===== Mute toggle =====
  muteBtn.addEventListener("click", () => {
    muted = !muted;
    if (muted) {
      stopAll();
      muteBtn.textContent = "ðŸ”‡ Sound Off";
    } else {
      // When unmuting, resume background ONLY (donâ€™t auto-play yes/no)
      playExclusive("bg");
      muteBtn.textContent = "ðŸ”Š Sound On";
    }
    muteBtn.setAttribute("aria-pressed", String(!muted));
  });

  // ===== Button actions =====
  // YES: stop bg, then play yes.mp3 (exclusive)
  yesBtn.addEventListener("click", async () => {
    await playExclusive("yes");
    setTimeout(() => {
      alert("Congratulations! You are my Valentine. <3");
    }, 120);
  });

  // NO: stop bg, then play No.mp3 (exclusive)
  noBtn.addEventListener("click", async () => {
    await playExclusive("no");
    noBtn.textContent = "Are you sure? ðŸ˜œ";
    setTimeout(() => (noBtn.textContent = "No"), 1200);
  });
</script>
